\section{Crossplatform Considerations} \label{sec:crossplatform}
\subsection{Background}
Up until now, only Linux based labs have been described.  However, to be competitive in today's market, many platforms need to be considered.  In CECS, we have a combination of Windows, Mac OSX, and various distributions of Linux.   Getting all of them to play nicely with each can often be an aggravating (sometimes maddening) process.  In addition, the choice of platforms is often dictated by people other than the System Administrators. 
\subsection{Centralized Accounting}
The most important thing to consider in a mixed platform environment is the user accounting system.  This is the system that manages login user IDs, user attributes, and passwords.  User attributes may consist of a user's full name, student/employee name, contact email, etc.  Some other useful attributes could be a list of courses that student takes or what his major is.  

At the very least, the system needs to manage user IDs and passwords centrally.  If this is not done, each platform must have its own central authentication system set up and each user must remember separate sets of user IDs and passwords (though the users may set them all the same).  This will also make shared resources among the different platforms difficult to use securely.  File servers in particular need a central authentication mechanism to know which files are owned by whom.  

There are two choices for central authentication that we have looked into.  The first is Network Information Services (NIS) with its set of yp commands.  This was created by Sun Microsystems as a method to exchange network and directory information between Unix systems.  The advantage to it is that every flavor of Unix supports it and will share passwd file information easily.  The disadvantage to it is that is shares information in clear text form.  This becomes a problem because password hash values can be sniffed if the network is breeched.  The other disadvantage is it will not natively support Microsoft Windows systems.  

The second choice is Microsoft Active Directory.  This is Microsoft's method for sharing information across Windows systems.  It can be difficult to configure but it is the ideal (and only) choice in a pure Windows environment.  The disadvantage is that Unix systems can not usually use it.  There have been many attempts at achieving compatibility and we are currently looking into another one, but no smooth tool has yet been made to fully support all of Microsoft's features.  

What we have done in CECS labs is have NIS manage authentication and created our own system to transfer credentials to a Windows Active Directory domain controller (sometimes called a PDC).  Unix clients can bind natively to an NIS namemaster while Windows clients must bind through Active Directory (AD).  Thus, we need two types of authentication: NIS and AD.  Our solution to this is called the search program.  We have a special user account called ``search" with the password ``account" that is the only method students can use to create their user accounts.  This program stores the usernames and passwords that students create in a clear text file temporarily.  This file is allowed to be read by another account called ntamaker (NT Account Maker).  This account is used from the PDC to access this clear text file.  Every 15 minutes, the PDC remotely copies the accounts in this file and adds them to its Active Directory accounts.  This is possible because it has access to clear text passwords for a brief period.  After it creates the accounts, it overwrites the file and erases the password information.

With the common accounts in place, we can then implement centralized file systems.  Since user IDs between different platforms are not usually the same, we are forced to go strictly by username.  This requires that all usernames are unique across all of our platforms.  It has not been an issue for CECS but it could potentially be for other environments.  With the usernames in place, the file servers can use them to distinguish who owns which files.  Thus, when users authenticate to either the NIS namemaster or the PDC, they are allowed to access files that they own.  The other problem that arises is incompatibility between Windows and Unix NFS.  Windows can only mount Samba shares.  This is fixed by running a Samba server on the printservers which is further described in detail in Chapter~\ref{ch:lab_infrastructure}, Section~\ref{sec:printservers}.  

\subsection{Software}
Even though a platform may not always work nicely with another platform, a lot of software has been ported to work across different platforms.  This is nice because certain labs can then be scheduled for use with multiple courses in a curriculum.  For example, Adobe's Web Development Suite has been ported to both Windows and Macintosh platforms.  So either lab can be scheduled for Web Development courses.  Eclipse and other Java based applications work on all platforms that a Java interpreter has been ported to.  This allows some flexibility in lab schedules so that courses that need platform specific software can get it more easily.  In addition, a lab may be able to remotely access servers of another platform.  For example, the Linux labs can be scheduled to use a Windows specific piece of software because students can use the ``rdesktop" command to remotely use a Windows Terminal Server.  

\subsection{Issues}
Issues with multiple platforms are many and varied.  It would be impossible to describe all of the issues we have faced, so I will give some of the more common examples.  

The biggest issue by far occurs when one platform updates and breaks compatibility with another platform.  For example, often during Apple OS X updates, either Samba, NFS, or NIS stops working as it did in previous versions.  Apple sometimes releases fixes after complaints, but we have had to do our own workarounds usually.  For example, when Samba broke, we could no longer bind the Macs to a Windows PDC.  We instead had to bind them to our Unix NIS namemaster.  However, the Macs could not support user home directories being NFS mounted.  After only a few minutes, the workstations would hang with no warning and have to be hard rebooted.  In addition, the error codes had no documentation available to help troubleshoot.  As a workaround, we mounted the directories to an alternate location and created a symbolic link to them.  However, in Apple's next release, even this workaround did not help because NIS was broken.  We ended up having to downgrade the workstations until Apple could release a patch six months later.

Another issue is the occasional failure to do Samba mounts.  This happens because Samba has an operation called an oplock for which NFS does not have an equivalent capability.  We have been able to mostly fix this issue by having the Samba server on the printservers fake oplocks.  We still occasionally have issues but they are minor.  

We also had trouble finding a client on Windows that could communicate via ssh or telnet easily.  When we upgraded to Windows 7, the Hyperterm program was removed.  We eventually found the Putty program that could use ssh and give shell access to Linux servers, but it did not have some of the features that we were used to in Hyperterm.  This invalidated the instruction sets we gave to faculty and caused confusion while we updated.  
