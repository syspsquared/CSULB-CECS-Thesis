\section{Lab Printing} \label{sec:lab_printing}
\subsection{Background}
Although digital copies of work are becoming more common, physical prints are still a practical necessity in labs, especially for education.  Instructors still collect paper copies and write feedback on them.  With the advent of tablet computing this is becoming less and less necessary but is still a requirement as of this writing.  

\subsection{Printing Setup}
Printing in labs is relatively straightforward to set up.  The simplest way to set up printing is to put the printer on a network and configure it as such.  With a network printer, this setup is made even easier by plugging the printer directly into the network and giving it a static IP.  This works in situations where paper quotas are not needed such as with faculty offices.  This assumes the faculty do not abuse the print privilege.  

In a student environment, however, it is usually not a good idea to assume students will not abuse the system.  In the case of CECS labs, we noticed that implementing a paper quota where student have to pay a small amount per paper ream caused the amount of printing to go down to reasonable levels.  As far as printing costs though, ink will almost always be the most expensive portion of print costs.  

That being said, a limited paper system is somewhat more complex to setup.  Most printers, even with network capability, will not have the features necessary.  Instead, the printer must be plugged into a print server that can manage print queues and a paper crediting system.  The server may have other functionality\footnote{The other functionality is described in Chapter~\ref{ch:lab_infrastructure}, Section~\ref{sec:printservers}.} but one of its main functions is to supply the labs with printing.  

The first step is choosing which printing system to use.  On Linux, the two choices are LPRNG (Line Printer Daemon Protocol) or CUPS (Common Unix Printing System).  CUPS seems to be the more common choice in most Linux distributions as of this writing.  However, while arguably having more features, it generates much more network traffic.  This could become a problem especially in mixed Windows and Linux environments.  CECS chose to use LPRNG.  Our main reason was because it is much less complicated to implement printing filters, which are necessary for the paper accounting system.

The LPRNG handles network printing without much configuration.  Clients simply have to point to it and send print jobs.  The accounting system requires more configuration.  The CECS accounting system was built in house using the standard TCP/IP stack in Unix.  At its core is the ``paperd" program hosted on one of the core servers.  It holds the master accounting files to keep track of how much paper a user has and how much they have used.  It is run by a dedicated user account, ``prmaster", which also has its own group.  

To credit a user's paper account, an administrator is added to the prmaster group which has the ability to run the modpaper command.  This must be done on the same server that paperd is housed on.  Thus, the administrator must be allowed to login to the core server and be in the prmaster group to edit user paper accounts.  

The clients in the paperd system are the printservers in each lab.  These run LPRNG and service print requests.  As part of LPRNG, the printers have a filter set up to catch who is printing what and forward that information to the master paperd system.  Assuming the user has paper in their paper account, the print job is sent to the printer. This only works if the workstations send the job to a printserver and by default we have them point to the one in the same room. They can point to printservers in other rooms in the event paper or ink runs out. 

\subsection{Printing Issues and Recent Changes}
While this system is fairly efficient, it has a few disadvantages.  The paperd is not using any form of encryption.  Technically, if someone on the network acts as a printserver they can send paper requests.  This is not feasible on networks where steps are taken to prevent spoofing.  This system also does not prevent people from unplugging the printers and plugging them into their own laptops.  For that, physical security of the labs needs to be maintained.  More importantly though, this system only tracks paper.  Is does not properly account for ink cartridges which are the true cost of printing.  These take a lot of the maintenance budget, but careful planning allowed us to manage for many years.  

Recently, our printing system has begun to be phased out.  Upper campus has installed their own printing system in our labs where students add paper credit from the bookstore and swipe their student ID cards to access their paper quotas.  They have paid for the printers, the paper, and most importantly the ink.  This gives us a significant portion of our maintenance budget back and cuts down our workload slightly by not having to manage a paper system.  However, this cost is transferred back to the students as the cost per black and white page is exceedingly expensive at 10 cents a page and the cost of color pages is prohibitively expensive at 1 dollar and 50 cents per page.  Though the cost of ink was expensive for us, if we were allowed to collect a small amount of money from the students to offset the ink cost, we could have only had them pay 3 cents a page for black and white.\footnote{The actual cost was calculated to be slightly less than 3 cents but we rounded up.}  

This has resulted in much less printing going on and a significant amount of confusion.  Faculty who realize the cost have also started to implement digital assignment submission.  This saves paper and ink but students do not get as much feedback on assignments digitally versus marking a physical page.  The final result of this new system and whether it will stay will ultimately be decided in the future.  
